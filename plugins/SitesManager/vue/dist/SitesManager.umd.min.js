(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SitesManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SitesManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,a){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(i,r,function(t){return e[t]}.bind(null,r));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/SitesManager/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"8bbf":function(e,a){e.exports=t},a5a2:function(e,t){e.exports=a},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"SiteTypesStore",(function(){return u})),a.d(t,"CurrencyStore",(function(){return b})),a.d(t,"TimezoneStore",(function(){return S})),a.d(t,"SitesManagement",(function(){return $e})),a.d(t,"ManageGlobalSettings",(function(){return Ct})),a.d(t,"ExcludeQueryParameterSettings",(function(){return Pt})),a.d(t,"SiteWithoutData",(function(){return qt})),"undefined"!==typeof window){var i=window.document.currentScript,r=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(a.p=r[1])}var l=a("8bbf"),n=a("19dc");function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},s.apply(this,arguments)}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const{$:c}=window;class d{constructor(){o(this,"state",Object(l["reactive"])({isLoading:!1,typesById:{}})),o(this,"typesById",Object(l["computed"])(()=>Object(l["readonly"])(this.state).typesById)),o(this,"isLoading",Object(l["computed"])(()=>Object(l["readonly"])(this.state).isLoading)),o(this,"types",Object(l["computed"])(()=>Object.values(this.typesById.value))),o(this,"response",void 0)}init(){return this.fetchAvailableTypes()}fetchAvailableTypes(){return this.response?Promise.resolve(this.response):(this.state.isLoading=!0,this.response=n["AjaxHelper"].fetch({method:"API.getAvailableMeasurableTypes",filter_limit:"-1"}).then(e=>(e.forEach(e=>{this.state.typesById[e.id]=e}),this.types.value)).finally(()=>{this.state.isLoading=!1}),this.response)}getEditSiteIdParameter(){const e=n["MatomoUrl"].hashQuery.value.match(/editsiteid=([0-9]+)/);if(!e)return;const t="1"===n["MatomoUrl"].urlParsed.value.showaddsite||"true"===n["MatomoUrl"].urlParsed.value.showaddsite,a=e[1];return a&&c.isNumeric(a)&&!t?a:void 0}removeEditSiteIdParameterFromHash(){const e=s({},n["MatomoUrl"].hashParsed.value);delete e.editsiteid,n["MatomoUrl"].updateHash(e)}}var u=new d;function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class h{constructor(){m(this,"privateState",Object(l["reactive"])({isLoading:!1,currencies:{}})),m(this,"currencies",Object(l["computed"])(()=>Object(l["readonly"])(this.privateState).currencies)),m(this,"isLoading",Object(l["computed"])(()=>Object(l["readonly"])(this.privateState).isLoading)),m(this,"initializePromise",null)}init(){return this.initializePromise||(this.initializePromise=this.fetchCurrencies()),this.initializePromise}fetchCurrencies(){return this.privateState.isLoading=!0,n["AjaxHelper"].fetch({method:"SitesManager.getCurrencyList"}).then(e=>{this.privateState.currencies=e}).finally(()=>{this.privateState.isLoading=!1})}}var b=new h;function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class g{constructor(){p(this,"privateState",Object(l["reactive"])({isLoading:!1,timezones:[],timezoneSupportEnabled:!1})),p(this,"state",Object(l["computed"])(()=>Object(l["readonly"])(this.privateState))),p(this,"timezones",Object(l["computed"])(()=>this.state.value.timezones)),p(this,"timezoneSupportEnabled",Object(l["computed"])(()=>this.state.value.timezoneSupportEnabled)),p(this,"isLoading",Object(l["computed"])(()=>this.state.value.isLoading)),p(this,"initializePromise",null)}init(){return this.initializePromise||(this.privateState.isLoading=!0,this.initializePromise=Promise.all([this.checkTimezoneSupportEnabled(),this.fetchTimezones()]).finally(()=>{this.privateState.isLoading=!1})),this.initializePromise}fetchTimezones(){return n["AjaxHelper"].fetch({method:"SitesManager.getTimezonesList"}).then(e=>{const t=[];Object.entries(e).forEach(([e,a])=>{Object.entries(a).forEach(([a,i])=>{t.push({group:e,label:a,code:i})})}),this.privateState.timezones=t})}checkTimezoneSupportEnabled(){return n["AjaxHelper"].fetch({method:"SitesManager.isTimezoneSupportEnabled"}).then(e=>{this.privateState.timezoneSupportEnabled=e.value})}}var S=new g;const O={class:"SitesManager",ref:"root"},j={class:"sites-manager-header"},y=["innerHTML"],v=Object(l["createElementVNode"])("br",null,null,-1),f=["innerHTML"],E={class:"loadingPiwik"},x=["alt"],N={class:"ui-confirm add-site-dialog"},V={class:"center"},M=["title","onClick"],T={class:"ui-button-text"},P={class:"sitesManagerList"},w={key:0},C={class:"bottomButtonBar"};function D(e,t,a,i,r,n){const s=Object(l["resolveComponent"])("EnrichedHeadline"),o=Object(l["resolveComponent"])("ButtonBar"),c=Object(l["resolveComponent"])("MatomoDialog"),d=Object(l["resolveComponent"])("SiteFields"),u=Object(l["resolveDirective"])("content-intro");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",O,[Object(l["createElementVNode"])("div",j,[Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[Object(l["withDirectives"])(Object(l["createElementVNode"])("h2",null,[Object(l["createVNode"])(s,{"help-url":e.externalRawLink("https://matomo.org/docs/manage-websites/"),"feature-name":e.translate("SitesManager_WebsitesManagement")},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.headlineText),1)]),_:1},8,["help-url","feature-name"])],512),[[l["vShow"],e.availableTypes.length]]),Object(l["createElementVNode"])("p",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_MainDescription"))+" ",1),Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(e.mainDescription)},null,8,y),Object(l["withDirectives"])(Object(l["createElementVNode"])("span",null,[v,Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(e.superUserAccessMessage)},null,8,f)],512),[[l["vShow"],e.hasSuperUserAccess]])])])),[[u]])]),Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])({hide_only:!e.isLoading})},[Object(l["createElementVNode"])("div",E,[Object(l["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:e.translate("General_LoadingData")},null,8,x),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_LoadingData")),1)])],2)]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(o,{"site-is-being-edited":e.isSiteBeingEdited,"has-prev":e.hasPrev,hasNext:e.hasNext,"offset-start":e.offsetStart,"offset-end":e.offsetEnd,"total-number-of-sites":e.totalNumberOfSites,"is-loading":e.isLoading,"search-term":e.searchTerm,"is-searching":!!e.activeSearchTerm,"onUpdate:searchTerm":t[0]||(t[0]=t=>e.searchTerm=t),onAdd:t[1]||(t[1]=t=>e.addNewEntity()),onSearch:t[2]||(t[2]=t=>e.searchSites(t)),onPrev:t[3]||(t[3]=t=>e.previousPage()),onNext:t[4]||(t[4]=t=>e.nextPage())},null,8,["site-is-being-edited","has-prev","hasNext","offset-start","offset-end","total-number-of-sites","is-loading","search-term","is-searching"])]),Object(l["createVNode"])(c,{modelValue:e.showAddSiteDialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.showAddSiteDialog=t)},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",N,[Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.translate("SitesManager_ChooseMeasurableTypeHeadline")),1),Object(l["createElementVNode"])("div",V,[Object(l["createElementVNode"])("p",null,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.availableTypes,t=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("button",{type:"button",key:t.id,title:t.description,class:"modal-close btn",onClick:a=>{e.addSite(t.id)},"aria-disabled":"false"},[Object(l["createElementVNode"])("span",T,Object(l["toDisplayString"])(t.name),1)],8,M))),128))])])])])]),_:1},8,["modelValue"]),Object(l["createElementVNode"])("div",P,[e.activeSearchTerm&&0===e.sites.length&&!e.isLoading?(Object(l["openBlock"])(),Object(l["createElementBlock"])("p",w,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_NotFound"))+" ",1),Object(l["createElementVNode"])("strong",null,Object(l["toDisplayString"])(e.activeSearchTerm),1)])):Object(l["createCommentVNode"])("",!0),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.sites,(a,i)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:a.idsite},[Object(l["createVNode"])(d,{site:a,"timezone-support-enabled":e.timezoneSupportEnabled,"utc-time":e.utcTime,"global-settings":e.globalSettings,onEditSite:t[6]||(t[6]=e=>this.isSiteBeingEdited=!0),onCancelEditSite:t[7]||(t[7]=t=>e.afterCancelEdit(t)),onDelete:t[8]||(t[8]=t=>e.afterDelete(t)),onSave:t=>e.afterSave(t.site,t.settingValues,i,t.isNew)},null,8,["site","timezone-support-enabled","utc-time","global-settings","onSave"])]))),128))]),Object(l["createElementVNode"])("div",C,[Object(l["createVNode"])(o,{"site-is-being-edited":e.isSiteBeingEdited,"has-prev":e.hasPrev,hasNext:e.hasNext,"offset-start":e.offsetStart,"offset-end":e.offsetEnd,"total-number-of-sites":e.totalNumberOfSites,"is-loading":e.isLoading,"search-term":e.searchTerm,"is-searching":!!e.activeSearchTerm,"onUpdate:searchTerm":t[9]||(t[9]=t=>e.searchTerm=t),onAdd:t[10]||(t[10]=t=>e.addNewEntity()),onSearch:t[11]||(t[11]=t=>e.searchSites(t)),onPrev:t[12]||(t[12]=t=>e.previousPage()),onNext:t[13]||(t[13]=t=>e.nextPage())},null,8,["site-is-being-edited","has-prev","hasNext","offset-start","offset-end","total-number-of-sites","is-loading","search-term","is-searching"])])],512)}const k={class:"sitesButtonBar clearfix"},_={class:"search"},G=["value","placeholder","disabled"],L=["title"],A={class:"paging"},U=["disabled"],B={style:{cursor:"pointer"}},I={class:"counter"},z=["disabled"],H={style:{cursor:"pointer"},class:"pointer"};function Q(e,t,a,i,r,n){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",k,[Object(l["withDirectives"])(Object(l["createElementVNode"])("a",{class:Object(l["normalizeClass"])(["btn addSite",{disabled:e.siteIsBeingEdited}]),onClick:t[0]||(t[0]=t=>e.addNewEntity()),tabindex:"1"},Object(l["toDisplayString"])(e.availableTypes.length>1?e.translate("SitesManager_AddMeasurable"):e.translate("SitesManager_AddSite")),3),[[l["vShow"],e.hasSuperUserAccess&&e.availableTypes]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",_,[Object(l["createElementVNode"])("input",{value:e.searchTerm,onKeydown:t[1]||(t[1]=t=>e.onKeydown(t)),placeholder:e.translate("Actions_SubmenuSitesearch"),type:"text",disabled:e.siteIsBeingEdited},null,40,G),Object(l["createElementVNode"])("div",{onClick:t[2]||(t[2]=t=>e.searchSite()),title:e.translate("General_ClickToSearch"),class:"search_ico icon-search"},null,8,L)],512),[[l["vShow"],e.hasPrev||e.hasNext||e.isSearching]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",A,[Object(l["createElementVNode"])("a",{class:"btn prev",disabled:!(e.hasPrev&&!e.isLoading&&!e.siteIsBeingEdited)||void 0,onClick:t[3]||(t[3]=t=>e.previousPage())},[Object(l["createElementVNode"])("span",B,"« "+Object(l["toDisplayString"])(e.translate("General_Previous")),1)],8,U),Object(l["withDirectives"])(Object(l["createElementVNode"])("span",I,[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.paginationText),1)],512),[[l["vShow"],e.hasPrev||e.hasNext]]),Object(l["createElementVNode"])("a",{class:"btn next",disabled:!(e.hasNext&&!e.isLoading&&!e.siteIsBeingEdited)||void 0,onClick:t[4]||(t[4]=t=>e.nextPage())},[Object(l["createElementVNode"])("span",H,Object(l["toDisplayString"])(e.translate("General_Next"))+" »",1)],8,z)],512),[[l["vShow"],e.hasPrev||e.hasNext]])])}var F=Object(l["defineComponent"])({props:{siteIsBeingEdited:{type:Boolean,required:!0},hasPrev:{type:Boolean,required:!0},hasNext:{type:Boolean,required:!0},offsetStart:{type:Number,required:!0},offsetEnd:{type:Number,required:!0},totalNumberOfSites:{type:Number},isLoading:{type:Boolean,required:!0},searchTerm:{type:String,required:!0},isSearching:{type:Boolean,required:!0}},emits:["add","search","prev","next","update:searchTerm"],created(){u.init(),this.onKeydown=Object(n["debounce"])(this.onKeydown,50)},computed:{hasSuperUserAccess(){return n["Matomo"].hasSuperUserAccess},availableTypes(){return u.types.value},paginationText(){let e;return e=this.isSearching?Object(n["translate"])("General_PaginationWithoutTotal",""+this.offsetStart,""+this.offsetEnd):Object(n["translate"])("General_Pagination",""+this.offsetStart,""+this.offsetEnd,null===this.totalNumberOfSites?"?":""+this.totalNumberOfSites),` ${e} `}},methods:{addNewEntity(){this.$emit("add")},searchSite(){this.siteIsBeingEdited||this.$emit("search")},previousPage(){this.$emit("prev")},nextPage(){this.$emit("next")},onKeydown(e){setTimeout(()=>{"Enter"!==e.key?this.$emit("update:searchTerm",e.target.value):this.searchSiteOnEnter(e)})},searchSiteOnEnter(e){e.preventDefault(),this.searchSite()}}});F.render=Q;var R=F;const $=["idsite","type"],W={class:"card-content"},K={key:0,class:"row"},q={class:"col m3"},Y={class:"title"},X={class:"title"},J=["target","title","href"],Z={class:"col m4"},ee={class:"title"},te={class:"title"},ae={class:"title"},ie={class:"title"},re={class:"col m4"},le={class:"title"},ne=["href"],se={key:0},oe={class:"title"},ce={key:1},de={class:"title"},ue={key:2},me={class:"title"},he={class:"col m1 text-right"},be=["title"],pe=Object(l["createElementVNode"])("span",{class:"icon-edit"},null,-1),ge=[pe],Se=["title"],Oe=Object(l["createElementVNode"])("span",{class:"icon-delete"},null,-1),je=[Oe],ye={key:1},ve={class:"form-group row"},fe={class:"col s12 m6 input-field"},Ee=["placeholder"],xe=Object(l["createElementVNode"])("div",{class:"col s12 m6"},null,-1),Ne={id:"timezoneHelpText",class:"inline-help-node"},Ve={key:0},Me=Object(l["createElementVNode"])("br",null,null,-1),Te=Object(l["createElementVNode"])("br",null,null,-1),Pe={class:"editingSiteFooter"},we=["disabled","value"],Ce=["disabled"],De=["innerHTML"];function ke(e,t,a,i,r,n){var s,o,c;const d=Object(l["resolveComponent"])("ActivityIndicator"),u=Object(l["resolveComponent"])("GroupedSettings"),m=Object(l["resolveComponent"])("Field"),h=Object(l["resolveComponent"])("PasswordConfirmation");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{class:Object(l["normalizeClass"])(["site card hoverable",{editingSite:!!e.editMode}]),idsite:e.theSite.idsite,type:e.theSite.type,ref:"root"},[Object(l["createElementVNode"])("div",W,[e.editMode?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",K,[Object(l["createElementVNode"])("div",q,[Object(l["createElementVNode"])("h4",null,Object(l["toDisplayString"])(e.theSite.name),1),Object(l["createElementVNode"])("ul",null,[Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",Y,Object(l["toDisplayString"])(e.translate("General_Id"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.theSite.idsite),1)]),Object(l["withDirectives"])(Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",X,Object(l["toDisplayString"])(e.translate("SitesManager_Type"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.currentType.name),1)],512),[[l["vShow"],e.availableTypes.length>1]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("a",{target:e.isInternalSetupUrl?"_self":"_blank",title:e.translate("SitesManager_ShowTrackingTag"),href:e.setupUrl},Object(l["toDisplayString"])(e.translate("SitesManager_ShowTrackingTag")),9,J)],512),[[l["vShow"],e.theSite.idsite&&e.howToSetupUrl]])])]),Object(l["createElementVNode"])("div",Z,[Object(l["createElementVNode"])("ul",null,[Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",ee,Object(l["toDisplayString"])(e.translate("SitesManager_Timezone"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.theSite.timezone_name),1)]),Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",te,Object(l["toDisplayString"])(e.translate("SitesManager_Currency"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.theSite.currency_name),1)]),Object(l["withDirectives"])(Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",ae,Object(l["toDisplayString"])(e.translate("Goals_Ecommerce"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Yes")),1)],512),[[l["vShow"],1===e.theSite.ecommerce||"1"===e.theSite.ecommerce]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",ie,Object(l["toDisplayString"])(e.translate("Actions_SubmenuSitesearch"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Yes")),1)],512),[[l["vShow"],1===e.theSite.sitesearch||"1"===e.theSite.sitesearch]])])]),Object(l["createElementVNode"])("div",re,[Object(l["createElementVNode"])("ul",null,[Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("span",le,Object(l["toDisplayString"])(e.translate("SitesManager_Urls")),1),Object(l["createTextVNode"])(": "),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.theSite.alias_urls,(t,a)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",{key:t},[Object(l["createElementVNode"])("a",{target:"_blank",rel:"noreferrer noopener",href:t},Object(l["toDisplayString"])(t)+Object(l["toDisplayString"])(a===e.theSite.alias_urls.length-1?"":", "),9,ne)]))),128))]),null!==(s=e.theSite.excluded_ips)&&void 0!==s&&s.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("li",se,[Object(l["createElementVNode"])("span",oe,Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedIps"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.theSite.excluded_ips.split(/\s*,\s*/g).join(", ")),1)])):Object(l["createCommentVNode"])("",!0),null!==(o=e.theSite.excluded_parameters)&&void 0!==o&&o.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("li",ce,[Object(l["createElementVNode"])("span",de,Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedParameters"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.theSite.excluded_parameters.split(/\s*,\s*/g).join(", ")),1)])):Object(l["createCommentVNode"])("",!0),null!==(c=e.theSite.excluded_user_agents)&&void 0!==c&&c.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("li",ue,[Object(l["createElementVNode"])("span",me,Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedUserAgents"))+":",1),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.theSite.excluded_user_agents.split(/\s*,\s*/g).join(", ")),1)])):Object(l["createCommentVNode"])("",!0)])]),Object(l["createElementVNode"])("div",he,[Object(l["createElementVNode"])("ul",null,[Object(l["createElementVNode"])("li",null,[Object(l["createElementVNode"])("button",{class:"table-action",onClick:t[0]||(t[0]=t=>e.editSite()),title:e.translate("General_Edit")},ge,8,be)]),Object(l["createElementVNode"])("li",null,[Object(l["withDirectives"])(Object(l["createElementVNode"])("button",{class:"table-action",onClick:t[1]||(t[1]=t=>e.getMessagesToWarnOnSiteRemoval()),title:e.translate("General_Delete")},je,8,Se),[[l["vShow"],e.theSite.idsite]])])])])])),e.editMode?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",ye,[Object(l["createElementVNode"])("div",ve,[Object(l["createElementVNode"])("div",fe,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.theSite.name=t),maxlength:"90",placeholder:e.translate("General_Name")},null,8,Ee),[[l["vModelText"],e.theSite.name]]),Object(l["createElementVNode"])("label",null,Object(l["toDisplayString"])(e.translate("General_Name")),1)]),xe]),Object(l["createVNode"])(d,{loading:e.isLoading},null,8,["loading"]),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.measurableSettings,t=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:t.pluginName},[Object(l["createVNode"])(u,{"group-name":t.pluginName,settings:t.settings,"all-setting-values":e.settingValues,onChange:a=>e.settingValues[`${t.pluginName}.${a.name}`]=a.value},null,8,["group-name","settings","all-setting-values","onChange"])]))),128)),Object(l["createVNode"])(m,{uicontrol:"select",name:"currency",modelValue:e.theSite.currency,"onUpdate:modelValue":t[3]||(t[3]=t=>e.theSite.currency=t),title:e.translate("SitesManager_Currency"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),options:e.currencies},null,8,["modelValue","title","inline-help","options"]),Object(l["createVNode"])(m,{uicontrol:"select",name:"timezone",modelValue:e.theSite.timezone,"onUpdate:modelValue":t[4]||(t[4]=t=>e.theSite.timezone=t),title:e.translate("SitesManager_Timezone"),"inline-help":"#timezoneHelpText",options:e.timezones},null,8,["modelValue","title","options"]),Object(l["createElementVNode"])("div",Ne,[Object(l["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",Ve,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),Me])),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.utcTimeIs)+" ",1),Te,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(l["createElementVNode"])("div",Pe,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{disabled:e.isSaving,type:"submit",class:"btn",value:e.translate("General_Save"),onClick:t[5]||(t[5]=t=>e.saveSite())},null,8,we),[[l["vShow"],!e.isLoading]]),Object(l["createElementVNode"])("button",{class:"btn btn-link",disabled:e.isSaving,onClick:t[6]||(t[6]=t=>e.cancelEditSite(e.site))},Object(l["toDisplayString"])(e.translate("General_Cancel","","")),9,Ce)])])):Object(l["createCommentVNode"])("",!0)]),Object(l["createVNode"])(h,{modelValue:e.showRemoveDialog,"onUpdate:modelValue":t[7]||(t[7]=t=>e.showRemoveDialog=t),onConfirmed:e.deleteSite},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.removeDialogTitle),1),Object(l["createElementVNode"])("p",null,Object(l["toDisplayString"])(e.translate("SitesManager_DeleteSiteExplanation")),1),e.deleteSiteExplanation?(Object(l["openBlock"])(),Object(l["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.deleteSiteExplanation)},null,8,De)):Object(l["createCommentVNode"])("",!0)]),_:1},8,["modelValue","onConfirmed"])],10,$)}var _e=a("a5a2");function Ge(){return Ge=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},Ge.apply(this,arguments)}const Le=Object(l["computed"])(()=>S.timezones.value.map(({group:e,label:t,code:a})=>({group:e,key:t,value:a})));function Ae(e){return"undefined"===typeof e.idsite}var Ue=Object(l["defineComponent"])({props:{site:{type:Object,required:!0},timezoneSupportEnabled:{type:Boolean},utcTime:{type:Date,required:!0},globalSettings:{type:Object,required:!0}},data(){return{isLoading:!1,isSaving:!1,editMode:!1,theSite:Ge({},this.site),measurableSettings:[],settingValues:{},showRemoveDialog:!1,deleteSiteExplanation:""}},components:{PasswordConfirmation:_e["PasswordConfirmation"],Field:_e["Field"],GroupedSettings:_e["GroupedSettings"],ActivityIndicator:n["ActivityIndicator"]},emits:["delete","editSite","cancelEditSite","save"],created(){b.init(),S.init(),u.init(),this.onSiteChanged()},watch:{site(){this.onSiteChanged()},measurableSettings(e){if(!e.length)return;const t={};e.forEach(e=>{e.settings.forEach(a=>{t[`${e.pluginName}.${a.name}`]=a.value})}),this.settingValues=t}},methods:{onSiteChanged(){const e=this.site;this.theSite=Ge({},e);const t=Ae(e);if(t){const e=this.globalSettings;this.theSite.timezone=e.defaultTimezone,this.theSite.currency=e.defaultCurrency}const a=u.getEditSiteIdParameter();(t||a&&""+e.idsite===a)&&this.editSite()},editSite(){if(this.editMode=!0,this.$emit("editSite",{idSite:this.theSite.idsite}),this.measurableSettings=[],Ae(this.theSite)){if(!this.currentType)return;this.measurableSettings=this.currentType.settings||[]}else this.isLoading=!0,n["AjaxHelper"].fetch({method:"SitesManager.getSiteSettings",idSite:this.theSite.idsite}).then(e=>{this.measurableSettings=e}).finally(()=>{this.isLoading=!1})},saveSite(){if(this.isSaving)return;this.isSaving=!0;const e={siteName:this.theSite.name,timezone:this.theSite.timezone,currency:this.theSite.currency,type:this.theSite.type,settingValues:{}},t=Ae(this.theSite);let a="SitesManager.addSite";t||(a="SitesManager.updateSite",e.idSite=this.theSite.idsite),Object.entries(this.settingValues).forEach(([t,a])=>{const[i,r]=t.split("."),l=e.settingValues;l[i]||(l[i]=[]);let n=a;!1===a?n="0":!0===a?n="1":Array.isArray(a)&&(n=a.filter(e=>!!e)),l[i].push({name:r,value:n})}),n["AjaxHelper"].post({method:a},e).then(a=>{this.editMode=!1,!this.theSite.idsite&&a&&a.value&&(this.theSite.idsite=""+a.value);const i=S.timezones.value.find(e=>e.code===this.theSite.timezone);this.theSite.timezone_name=(null===i||void 0===i?void 0:i.label)||this.theSite.timezone,this.theSite.currency&&(this.theSite.currency_name=b.currencies.value[this.theSite.currency]);const r=n["NotificationsStore"].show({message:t?Object(n["translate"])("SitesManager_WebsiteCreated"):Object(n["translate"])("SitesManager_WebsiteUpdated"),context:"success",id:"websitecreated",type:"transient"});n["NotificationsStore"].scrollToNotification(r),u.removeEditSiteIdParameterFromHash(),this.$emit("save",{site:this.theSite,settingValues:e.settingValues,isNew:t})}).finally(()=>{this.isSaving=!1})},cancelEditSite(e){this.editMode=!1,u.removeEditSiteIdParameterFromHash(),this.$emit("cancelEditSite",{site:e,element:this.$refs.root})},deleteSite(e){n["AjaxHelper"].post({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.deleteSite"},{passwordConfirmation:e}).then(()=>{this.$emit("delete",this.theSite)})},getMessagesToWarnOnSiteRemoval(){n["AjaxHelper"].post({idSite:this.theSite.idsite,module:"API",format:"json",method:"SitesManager.getMessagesToWarnOnSiteRemoval"}).then(e=>{this.deleteSiteExplanation="",e.length&&(this.deleteSiteExplanation+=e.join("<br>")),this.showRemoveDialog=!0})}},computed:{availableTypes(){return u.types.value},setupUrl(){const e=this.theSite;let t="",a="";return this.isInternalSetupUrl&&(t=n["MatomoUrl"].stringify({idSite:e.idsite,period:n["MatomoUrl"].parsed.value.period,date:n["MatomoUrl"].parsed.value.date,updated:"false"}),a=-1===this.howToSetupUrl.indexOf("?")?"?":"&"),`${this.howToSetupUrl}${a}${t}`},utcTimeIs(){const e=this.utcTime,t=e=>e.toString().padStart(2,"0"),a=t(e.getHours()),i=t(e.getMinutes()),r=t(e.getSeconds()),l=`${Object(n["format"])(this.utcTime)} ${a}:${i}:${r}`;return Object(n["translate"])("SitesManager_UTCTimeIs",l)},timezones(){return Le.value},currencies(){return b.currencies.value},currentType(){const e=this.site,t=u.typesById.value[e.type];return t||{name:e.type}},howToSetupUrl(){const e=this.currentType;if(e)return e.howToSetupUrl},isInternalSetupUrl(){const{howToSetupUrl:e}=this;return!!e&&"?"===(""+e).substring(0,1)},removeDialogTitle(){return Object(n["translate"])("SitesManager_DeleteConfirm",`"${this.theSite.name}" (idSite = ${this.theSite.idsite})`)}}});Ue.render=ke;var Be=Ue;function Ie(){return Ie=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},Ie.apply(this,arguments)}function ze(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class He{constructor(){ze(this,"privateState",Object(l["reactive"])({isLoading:!1,globalSettings:{keepURLFragmentsGlobal:!1,defaultCurrency:"",defaultTimezone:"",excludedIpsGlobal:"",excludedQueryParametersGlobal:"",excludedUserAgentsGlobal:"",excludedReferrersGlobal:"",searchKeywordParametersGlobal:"",searchCategoryParametersGlobal:"",exclusionTypeForQueryParams:""}})),ze(this,"isLoading",Object(l["computed"])(()=>Object(l["readonly"])(this.privateState).isLoading)),ze(this,"globalSettings",Object(l["computed"])(()=>Object(l["readonly"])(this.privateState).globalSettings))}init(){return this.fetchGlobalSettings()}saveGlobalSettings(e){return this.privateState.isLoading=!0,n["AjaxHelper"].post({module:"SitesManager",format:"json",action:"setGlobalSettings"},e,{withTokenInUrl:!0}).finally(()=>{this.privateState.isLoading=!1})}fetchGlobalSettings(){this.privateState.isLoading=!0,n["AjaxHelper"].fetch({module:"SitesManager",action:"getGlobalSettings"}).then(e=>{this.privateState.globalSettings=Ie(Ie({},e),{},{excludedIpsGlobal:e.excludedIpsGlobal||"",excludedQueryParametersGlobal:e.excludedQueryParametersGlobal||"",excludedUserAgentsGlobal:e.excludedUserAgentsGlobal||"",excludedReferrersGlobal:e.excludedReferrersGlobal||"",searchKeywordParametersGlobal:e.searchKeywordParametersGlobal||"",searchCategoryParametersGlobal:e.searchCategoryParametersGlobal||"",exclusionTypeForQueryParams:e.exclusionTypeForQueryParams||""})}).finally(()=>{this.privateState.isLoading=!1})}}var Qe=new He;function Fe(){return Fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},Fe.apply(this,arguments)}var Re=Object(l["defineComponent"])({props:{dummy:String},components:{MatomoDialog:n["MatomoDialog"],ButtonBar:R,SiteFields:Be,EnrichedHeadline:n["EnrichedHeadline"]},directives:{ContentIntro:n["ContentIntro"]},data(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return{pageSize:10,currentPage:0,showAddSiteDialog:!1,searchTerm:"",activeSearchTerm:"",fetchedSites:[],isLoadingInitialEntities:!1,utcTime:t,totalNumberOfSites:null,isSiteBeingEdited:!1,fetchLimitedSitesAbortController:null}},created(){S.init(),u.init(),Qe.init(),this.isLoadingInitialEntities=!0,Promise.all([u.fetchAvailableTypes(),this.fetchLimitedSitesWithAdminAccess(),this.getTotalNumberOfSites()]).then(()=>{this.triggerAddSiteIfRequested()}).finally(()=>{this.isLoadingInitialEntities=!1}),Object(l["watch"])(()=>n["MatomoUrl"].hashQuery.value,()=>{this.checkGlobalSettingsHash()})},computed:{sites(){const e=this.fetchedSites.filter(e=>!e.idsite).length;return this.fetchedSites.slice(0,this.pageSize+e)},isLoading(){return!!this.fetchLimitedSitesAbortController||this.isLoadingInitialEntities||null===this.totalNumberOfSites||u.isLoading.value||S.isLoading.value||Qe.isLoading.value},availableTypes(){return u.types.value},timezoneSupportEnabled(){return S.timezoneSupportEnabled.value},globalSettings(){return Qe.globalSettings.value},headlineText(){return Object(n["translate"])("SitesManager_XManagement",this.availableTypes.length>1?Object(n["translate"])("General_Measurables"):Object(n["translate"])("SitesManager_Sites"))},mainDescription(){return Object(n["translate"])("SitesManager_YouCurrentlyHaveAccessToNWebsites",`<strong>${this.totalNumberOfSites}</strong>`)},hasSuperUserAccess(){return n["Matomo"].hasSuperUserAccess},superUserAccessMessage(){return Object(n["translate"])("SitesManager_SuperUserAccessCan","<a href='#globalSettings'>","</a>")},hasPrev(){return this.currentPage>=1},hasNext(){return this.fetchedSites.filter(e=>!!e.idsite).length>=this.pageSize+1},offsetStart(){return this.currentPage*this.pageSize+1},offsetEnd(){return this.offsetStart+this.sites.filter(e=>!!e.idsite).length-1}},methods:{checkGlobalSettingsHash(){const e=n["MatomoUrl"].hashQuery.value;!n["Matomo"].hasSuperUserAccess||"globalSettings"!==e&&"/globalSettings"!==e||n["MatomoUrl"].updateLocation(Fe(Fe({},n["MatomoUrl"].urlParsed.value),{},{action:"globalSettings"}))},addNewEntity(){this.availableTypes.length>1?this.showAddSiteDialog=!0:1===this.availableTypes.length&&this.addSite(this.availableTypes[0].id)},addSite(e){let t=e;const a={isAllowed:!0,measurableType:t};n["Matomo"].postEvent("SitesManager.initAddSite",a),a&&!a.isAllowed||(t||(t="website"),this.fetchedSites.unshift({type:t}),this.isSiteBeingEdited=!0)},afterCancelEdit({site:e,element:t}){this.isSiteBeingEdited=!1,e.idsite?t.scrollIntoView():this.fetchedSites=this.fetchedSites.filter(e=>!!e.idsite)},fetchLimitedSitesWithAdminAccess(e=""){this.fetchLimitedSitesAbortController&&this.fetchLimitedSitesAbortController.abort(),this.fetchLimitedSitesAbortController=new AbortController;const t=this.pageSize+1,a=this.currentPage*this.pageSize,i={method:"SitesManager.getSitesWithAdminAccess",fetchAliasUrls:1,limit:t+a,filter_offset:a,filter_limit:t};return e&&(i.pattern=e),n["AjaxHelper"].fetch(i).then(e=>{this.fetchedSites=e||[]}).then(t=>(this.activeSearchTerm=e,t)).finally(()=>{this.fetchLimitedSitesAbortController=null})},getTotalNumberOfSites(){return n["AjaxHelper"].fetch({method:"SitesManager.getSitesIdWithAdminAccess",filter_limit:"-1"}).then(e=>{this.totalNumberOfSites=e.length})},triggerAddSiteIfRequested(){const e=u.getEditSiteIdParameter(),t=n["MatomoUrl"].urlParsed.value.showaddsite;"1"===t?this.addNewEntity():e&&(this.searchTerm=e,this.fetchLimitedSitesWithAdminAccess(this.searchTerm))},previousPage(){this.currentPage=Math.max(0,this.currentPage-1),this.fetchLimitedSitesWithAdminAccess(this.activeSearchTerm)},nextPage(){this.currentPage=Math.max(0,this.currentPage+1),this.fetchLimitedSitesWithAdminAccess(this.activeSearchTerm)},searchSites(){this.currentPage=0,this.fetchLimitedSitesWithAdminAccess(this.searchTerm)},afterDelete(e){let t={showaddsite:0};if(n["MatomoUrl"].urlParsed.value.idSite===""+e.idsite){const a=this.sites.find(t=>t.idsite!==e.idsite);a&&(t=Fe(Fe({},t),{},{idSite:a.idsite}))}n["Matomo"].helper.redirect(t)},afterSave(e,t,a,i){const r=["excluded_ips","excluded_parameters","excluded_user_agents","sitesearch_keyword_parameters","sitesearch_category_parameters"],l=Fe({},e);Object.values(t).forEach(e=>{e.forEach(e=>{"urls"===e.name?l.alias_urls=e.value:-1!==r.indexOf(e.name)?l[e.name]=e.value.join(", "):l[e.name]=e.value})}),this.fetchedSites[a]=l,i&&null!==this.totalNumberOfSites&&(this.totalNumberOfSites+=1),this.isSiteBeingEdited=!1}}});Re.render=D;var $e=Re;const We={class:"SitesManager"},Ke=Object(l["createElementVNode"])("a",{name:"globalSettings",id:"globalSettings"},null,-1),qe={id:"excludedIpsGlobalHelp",class:"inline-help-node"},Ye=Object(l["createElementVNode"])("br",null,null,-1),Xe=Object(l["createElementVNode"])("br",null,null,-1),Je=["innerHTML"],Ze={id:"excludedUserAgentsGlobalHelp",class:"inline-help-node"},et=Object(l["createElementVNode"])("br",null,null,-1),tt=Object(l["createElementVNode"])("br",null,null,-1),at={id:"excludedReferrersGlobalHelp",class:"inline-help-node"},it=Object(l["createElementVNode"])("br",null,null,-1),rt=Object(l["createElementVNode"])("br",null,null,-1),lt=Object(l["createElementVNode"])("br",null,null,-1),nt=Object(l["createElementVNode"])("br",null,null,-1),st=Object(l["createElementVNode"])("br",null,null,-1),ot={id:"timezoneHelp",class:"inline-help-node"},ct={key:0},dt=Object(l["createElementVNode"])("br",null,null,-1),ut=Object(l["createElementVNode"])("br",null,null,-1),mt={id:"keepURLFragmentsHelp",class:"inline-help-node"},ht=["innerHTML"],bt={class:"alert alert-info"};function pt(e,t,a,i,r,n){const s=Object(l["resolveComponent"])("Field"),o=Object(l["resolveComponent"])("ExcludeQueryParameterSettings"),c=Object(l["resolveComponent"])("SaveButton"),d=Object(l["resolveComponent"])("ContentBlock");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",We,[Object(l["withDirectives"])(Object(l["createVNode"])(d,{"content-title":e.translate("SitesManager_GlobalWebsitesSettings")},{default:Object(l["withCtx"])(()=>[Ke,Object(l["createElementVNode"])("div",qe,[Object(l["createElementVNode"])("div",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_HelpExcludedIpAddresses","1.2.3.4/24","1.2.3.*","1.2.*.*"))+" ",1),Ye,Xe,Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(e.yourCurrentIpAddressIs)},null,8,Je)])]),Object(l["createElementVNode"])("div",Ze,[Object(l["createElementVNode"])("div",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp1"))+" ",1),et,tt,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_GlobalListExcludedUserAgents_Desc"))+" "+Object(l["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp2"))+" "+Object(l["toDisplayString"])(e.translate("SitesManager_GlobalExcludedUserAgentHelp3","/bot|spider|crawl|scanner/i")),1)])]),Object(l["createElementVNode"])("div",at,[Object(l["createElementVNode"])("div",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelp"))+" ",1),it,rt,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelpDetails"))+" ",1),lt,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelpExamples","www.example.org","http://example.org/mypath","https://www.example.org/?param=1","https://sub.example.org/"))+" ",1),nt,st,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_ExcludedReferrersHelpSubDomains",".sub.example.org","http://sub.example.org/mypath","https://new.sub.example.org/")),1)])]),Object(l["createElementVNode"])("div",ot,[Object(l["createElementVNode"])("div",null,[e.timezoneSupportEnabled?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",ct,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_AdvancedTimezoneSupportNotFound"))+" ",1),dt])),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_UTCTimeIs",e.utcTimeDate))+" ",1),ut,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_ChangingYourTimezoneWillOnlyAffectDataForward")),1)])]),Object(l["createElementVNode"])("div",mt,[Object(l["createElementVNode"])("div",{innerHTML:e.$sanitize(e.keepUrlFragmentHelp)},null,8,ht),Object(l["createElementVNode"])("div",null,Object(l["toDisplayString"])(e.translate("SitesManager_KeepURLFragmentsHelp2")),1)]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"textarea",name:"excludedIpsGlobal","var-type":"array",modelValue:e.excludedIpsGlobal,"onUpdate:modelValue":t[0]||(t[0]=t=>e.excludedIpsGlobal=t),title:e.translate("SitesManager_ListOfIpsToBeExcludedOnAllWebsites"),introduction:e.translate("SitesManager_GlobalListExcludedIps"),"inline-help":"#excludedIpsGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(l["createVNode"])(o,{exclusionTypeForQueryParams:e.exclusionTypeForQueryParams,"onUpdate:exclusionTypeForQueryParams":t[1]||(t[1]=t=>e.exclusionTypeForQueryParams=t),excludedQueryParametersGlobal:e.excludedQueryParametersGlobal,"onUpdate:excludedQueryParametersGlobal":t[2]||(t[2]=t=>e.excludedQueryParametersGlobal=t),commonSensitiveQueryParams:e.commonSensitiveQueryParams},null,8,["exclusionTypeForQueryParams","excludedQueryParametersGlobal","commonSensitiveQueryParams"]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"textarea",name:"excludedUserAgentsGlobal","var-type":"array",modelValue:e.excludedUserAgentsGlobal,"onUpdate:modelValue":t[3]||(t[3]=t=>e.excludedUserAgentsGlobal=t),title:e.translate("SitesManager_GlobalListExcludedUserAgents_Desc"),introduction:e.translate("SitesManager_GlobalListExcludedUserAgents"),"inline-help":"#excludedUserAgentsGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"textarea",name:"excludedReferrersGlobal","var-type":"array",modelValue:e.excludedReferrersGlobal,"onUpdate:modelValue":t[4]||(t[4]=t=>e.excludedReferrersGlobal=t),title:e.translate("SitesManager_GlobalListExcludedReferrersDesc"),introduction:e.translate("SitesManager_GlobalListExcludedReferrers"),"inline-help":"#excludedReferrersGlobalHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"checkbox",name:"keepURLFragmentsGlobal",modelValue:e.keepURLFragmentsGlobal,"onUpdate:modelValue":t[5]||(t[5]=t=>e.keepURLFragmentsGlobal=t),title:e.translate("SitesManager_KeepURLFragmentsLong"),introduction:e.translate("SitesManager_KeepURLFragments"),"inline-help":"#keepURLFragmentsHelp",disabled:e.isLoading},null,8,["modelValue","title","introduction","disabled"])]),Object(l["createElementVNode"])("h3",null,Object(l["toDisplayString"])(e.translate("SitesManager_TrackingSiteSearch")),1),Object(l["createElementVNode"])("p",null,Object(l["toDisplayString"])(e.translate("SitesManager_SiteSearchUse")),1),Object(l["createElementVNode"])("div",bt,Object(l["toDisplayString"])(e.translate("SitesManager_SearchParametersNote"))+" "+Object(l["toDisplayString"])(e.translate("SitesManager_SearchParametersNote2")),1),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"text",name:"searchKeywordParametersGlobal","var-type":"array",modelValue:e.searchKeywordParametersGlobal,"onUpdate:modelValue":t[6]||(t[6]=t=>e.searchKeywordParametersGlobal=t),title:e.translate("SitesManager_SearchKeywordLabel"),"inline-help":e.translate("SitesManager_SearchKeywordParametersDesc"),disabled:e.isLoading},null,8,["modelValue","title","inline-help","disabled"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"text",name:"searchCategoryParametersGlobal","var-type":"array",modelValue:e.searchCategoryParametersGlobal,"onUpdate:modelValue":t[7]||(t[7]=t=>e.searchCategoryParametersGlobal=t),title:e.translate("SitesManager_SearchCategoryLabel"),"inline-help":e.searchCategoryParamsInlineHelp,disabled:e.isLoading},null,8,["modelValue","title","inline-help","disabled"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"select",name:"defaultTimezone",options:e.timezoneOptions,title:e.translate("SitesManager_SelectDefaultTimezone"),introduction:e.translate("SitesManager_DefaultTimezoneForNewWebsites"),"inline-help":"#timezoneHelp",disabled:e.isLoading,modelValue:e.defaultTimezone,"onUpdate:modelValue":t[8]||(t[8]=t=>e.defaultTimezone=t)},null,8,["options","title","introduction","disabled","modelValue"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"select",name:"defaultCurrency",modelValue:e.defaultCurrency,"onUpdate:modelValue":t[9]||(t[9]=t=>e.defaultCurrency=t),options:e.currencies,title:e.translate("SitesManager_SelectDefaultCurrency"),introduction:e.translate("SitesManager_DefaultCurrencyForNewWebsites"),"inline-help":e.translate("SitesManager_CurrencySymbolWillBeUsedForGoals"),disabled:e.isLoading},null,8,["modelValue","options","title","introduction","inline-help","disabled"])]),Object(l["createVNode"])(c,{saving:e.isSaving,onConfirm:t[10]||(t[10]=t=>e.saveGlobalSettings())},null,8,["saving"])]),_:1},8,["content-title"]),[[l["vShow"],e.hasSuperUserAccess]])])}const gt={class:"siteManagerGlobalExcludedUrlParameters"},St={id:"excludedQueryParametersGlobalHelp",class:"inline-help-node"},Ot={id:"excludedQueryParametersGlobalExclusionTypeHelp",class:"inline-help-node"},jt=Object(l["createElementVNode"])("span",{class:"icon-chevron-down"},null,-1),yt=Object(l["createElementVNode"])("span",{class:"icon-chevron-up"},null,-1),vt={key:0},ft=Object(l["createElementVNode"])("br",null,null,-1),Et=Object(l["createElementVNode"])("br",null,null,-1),xt=Object(l["createElementVNode"])("br",null,null,-1),Nt=Object(l["createElementVNode"])("br",null,null,-1),Vt=["value"];function Mt(e,t,a,i,r,n){const s=Object(l["resolveComponent"])("Field");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",gt,[Object(l["createElementVNode"])("div",St,[Object(l["createElementVNode"])("div",null,Object(l["toDisplayString"])(e.translate("SitesManager_ListOfQueryParametersToExclude","/^sess.*|.*[dD]ate$/")),1)]),Object(l["createElementVNode"])("div",Ot,[Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,Object(l["toDisplayString"])(e.translate("SitesManager_ExclusionTypeDescriptionCommonSessionParameters")),513),[[l["vShow"],"common_session_parameters"===e.localExclusionTypeForQueryParams]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("p",null,Object(l["toDisplayString"])(e.translate("SitesManager_ExclusionTypeDescriptionMatomoRecommendedPII")),1),Object(l["createElementVNode"])("div",null,[e.showListOfCommonExclusions?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:0,href:"javascript:;",onClick:t[0]||(t[0]=Object(l["withModifiers"])(t=>e.showListOfCommonExclusions=!0,["prevent"]))},[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_ExclusionViewListLink"))+" ",1),jt])),e.showListOfCommonExclusions?(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:1,href:"javascript:;",onClick:t[1]||(t[1]=Object(l["withModifiers"])(t=>e.showListOfCommonExclusions=!1,["prevent"]))},[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_ExclusionViewListLink"))+" ",1),yt])):Object(l["createCommentVNode"])("",!0)]),e.showListOfCommonExclusions?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",vt,Object(l["toDisplayString"])(e.commonSensitiveQueryParams.join(", ")),1)):Object(l["createCommentVNode"])("",!0),ft,Et,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_MatomoWillAutomaticallyExcludeCommonSessionParametersInAddition","phpsessid, sessionid, ...")),1)],512),[[l["vShow"],"matomo_recommended_pii"===e.localExclusionTypeForQueryParams]]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("SitesManager_ExclusionTypeDescriptionCustom"))+" ",1),xt,Nt,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("SitesManager_MatomoWillAutomaticallyExcludeCommonSessionParametersInAddition","phpsessid, sessionid, ...")),1)],512),[[l["vShow"],"custom"===e.localExclusionTypeForQueryParams]])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"radio",name:"exclusionType",introduction:e.translate("SitesManager_GlobalListExcludedQueryParameters"),options:e.exclusionTypeOptions,modelValue:e.localExclusionTypeForQueryParams,"onUpdate:modelValue":t[2]||(t[2]=t=>e.localExclusionTypeForQueryParams=t),"inline-help":"#excludedQueryParametersGlobalExclusionTypeHelp"},null,8,["introduction","options","modelValue"])]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(s,{uicontrol:"textarea",name:"excludedQueryParametersGlobal","var-type":"array",class:"limited-height-scrolling-textarea",modelValue:e.localExcludedQueryParametersGlobal,"onUpdate:modelValue":t[3]||(t[3]=t=>e.localExcludedQueryParametersGlobal=t),"model-value":e.localExcludedQueryParametersGlobal.join("\n"),onInput:t[4]||(t[4]=t=>e.onInputExcludedQueryParametersGlobal(t.target.value)),title:e.translate("SitesManager_ListOfQueryParametersToBeExcludedOnAllWebsites"),"inline-help":"#excludedQueryParametersGlobalHelp"},null,8,["modelValue","model-value","title"]),Object(l["createElementVNode"])("input",{type:"button",onClick:t[5]||(t[5]=t=>e.addCommonPIIQueryParams()),class:"btn",value:e.translate("SitesManager_AddSensibleExclusionsToMyCustomListButtonText")},null,8,Vt)],512),[[l["vShow"],"custom"===e.localExclusionTypeForQueryParams]])])}var Tt=Object(l["defineComponent"])({components:{Field:_e["Field"]},props:{exclusionTypeForQueryParams:{type:String,default:"common_session_parameters"},excludedQueryParametersGlobal:{type:Array,default:()=>[]},commonSensitiveQueryParams:{type:Array,default:()=>[]}},data(){return{localExclusionTypeForQueryParams:this.exclusionTypeForQueryParams,localExcludedQueryParametersGlobal:this.excludedQueryParametersGlobal,exclusionTypeOptions:[{value:Object(n["translate"])("SitesManager_ExclusionTypeOptionCommonSessionParameters"),key:"common_session_parameters"},{value:Object(n["translate"])("SitesManager_ExclusionTypeOptionMatomoRecommendedPII"),key:"matomo_recommended_pii"},{value:Object(n["translate"])("SitesManager_ExclusionTypeOptionCustom"),key:"custom"}],showListOfCommonExclusions:!1}},watch:{exclusionTypeForQueryParams:{handler(e){this.localExclusionTypeForQueryParams=e}},localExclusionTypeForQueryParams:{handler(e){this.updateExclusionType(e)},immediate:!0},excludedQueryParametersGlobal:{handler(e){this.localExcludedQueryParametersGlobal=e}}},methods:{updateExclusionType(e){"custom"!==e&&(this.localExcludedQueryParametersGlobal=[],this.onInputExcludedQueryParametersGlobal("")),this.$emit("update:exclusionTypeForQueryParams",e)},onInputExcludedQueryParametersGlobal(e){const t=e.split("\n");this.$emit("update:excludedQueryParametersGlobal",t)},addCommonPIIQueryParams(){let e=this.localExcludedQueryParametersGlobal.filter(e=>!this.commonSensitiveQueryParams.includes(e));e=e.concat(this.commonSensitiveQueryParams),this.localExcludedQueryParametersGlobal=e,this.$emit("update:excludedQueryParametersGlobal",e)}}});Tt.render=Mt;var Pt=Tt,wt=Object(l["defineComponent"])({components:{ExcludeQueryParameterSettings:Pt,ContentBlock:n["ContentBlock"],Field:_e["Field"],SaveButton:_e["SaveButton"]},props:{commonSensitiveQueryParams:{type:Array,default:()=>[]}},data(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),a=Qe.globalSettings.value;return{currentIpAddress:null,utcTime:t,keepURLFragmentsGlobal:a.keepURLFragmentsGlobal,defaultTimezone:a.defaultTimezone,defaultCurrency:a.defaultCurrency,excludedIpsGlobal:(a.excludedIpsGlobal||"").split(","),excludedQueryParametersGlobal:(a.excludedQueryParametersGlobal||"").split(","),excludedUserAgentsGlobal:(a.excludedUserAgentsGlobal||"").split(","),excludedReferrersGlobal:(a.excludedReferrersGlobal||"").split(","),searchKeywordParametersGlobal:(a.searchKeywordParametersGlobal||"").split(","),searchCategoryParametersGlobal:(a.searchCategoryParametersGlobal||"").split(","),isSaving:!1,exclusionTypeForQueryParams:a.exclusionTypeForQueryParams}},created(){b.init(),S.init(),Qe.init(),Object(l["watch"])(()=>Qe.globalSettings.value,e=>{this.keepURLFragmentsGlobal=e.keepURLFragmentsGlobal,this.defaultTimezone=e.defaultTimezone,this.defaultCurrency=e.defaultCurrency,this.excludedIpsGlobal=(e.excludedIpsGlobal||"").split(","),this.excludedQueryParametersGlobal=(e.excludedQueryParametersGlobal||"").split(","),this.excludedUserAgentsGlobal=(e.excludedUserAgentsGlobal||"").split(","),this.excludedReferrersGlobal=(e.excludedReferrersGlobal||"").split(","),this.searchKeywordParametersGlobal=(e.searchKeywordParametersGlobal||"").split(","),this.searchCategoryParametersGlobal=(e.searchCategoryParametersGlobal||"").split(","),this.exclusionTypeForQueryParams=e.exclusionTypeForQueryParams}),n["AjaxHelper"].fetch({method:"API.getIpFromHeader"}).then(e=>{this.currentIpAddress=e.value})},methods:{saveGlobalSettings(){this.isSaving=!0,Qe.saveGlobalSettings({keepURLFragments:this.keepURLFragmentsGlobal,currency:this.defaultCurrency,timezone:this.defaultTimezone,excludedIps:this.excludedIpsGlobal.join(","),excludedQueryParameters:this.excludedQueryParametersGlobal.join(","),excludedUserAgents:this.excludedUserAgentsGlobal.join(","),excludedReferrers:this.excludedReferrersGlobal.join(","),searchKeywordParameters:this.searchKeywordParametersGlobal.join(","),searchCategoryParameters:this.searchCategoryParametersGlobal.join(","),exclusionTypeForQueryParams:this.exclusionTypeForQueryParams}).then(()=>{n["Matomo"].helper.redirect({showaddsite:!1})}).finally(()=>{this.isSaving=!1})}},computed:{isLoading(){return Qe.isLoading.value||S.isLoading.value||b.isLoading.value},timezones(){return S.timezones.value},timezoneOptions(){return this.timezones.map(({group:e,label:t,code:a})=>({group:e,key:t,value:a}))},currencies(){return b.currencies.value},hasSuperUserAccess(){return n["Matomo"].hasSuperUserAccess},yourCurrentIpAddressIs(){return Object(n["translate"])("SitesManager_YourCurrentIpAddressIs",`<i>${this.currentIpAddress}</i>`)},timezoneSupportEnabled(){return S.timezoneSupportEnabled.value},utcTimeDate(){const{utcTime:e}=this,t=e=>e.toString().padStart(2,"0"),a=t(e.getHours()),i=t(e.getMinutes()),r=t(e.getSeconds());return`${Object(n["format"])(this.utcTime)} ${a}:${i}:${r}`},keepUrlFragmentHelp(){return Object(n["translate"])("SitesManager_KeepURLFragmentsHelp","<em>#</em>","<em>example.org/index.html#first_section</em>","<em>example.org/index.html</em>")},searchCategoryParamsInlineHelp(){const e=[Object(n["translate"])("Goals_Optional"),Object(n["translate"])("SitesManager_SearchCategoryDesc"),Object(n["translate"])("SitesManager_SearchCategoryParametersDesc")];return e.join(" ")}}});wt.render=pt;var Ct=wt;const Dt=Object(l["createElementVNode"])("span",{class:"icon-chevron-left"},null,-1),kt={id:"start-tracking-data-header"},_t={key:0,class:"row",id:"start-tracking-detection"},Gt=["src","alt"],Lt=["href"],At={class:"row",id:"start-tracking-method-list"},Ut=Object(l["createElementVNode"])("span",{class:"icon-search"},null,-1),Bt=["href","onClick"],It=["src"],zt={class:"list-entry-text"},Ht={id:"start-tracking-skip"},Qt=["href"],Ft=["data-method"],Rt=["src","alt"];function $t(e,t,a,i,r,n){const s=Object(l["resolveComponent"])("VueEntryContainer"),o=Object(l["resolveComponent"])("ActivityIndicator");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",null,[e.showMethodDetails?(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:0,id:"start-tracking-back",onClick:t[0]||(t[0]=Object(l["withModifiers"])(t=>{e.showOverview()},["prevent"]))},[Dt,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("Mobile_NavigationBack")),1)])):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("h1",kt,Object(l["toDisplayString"])(e.headline),1),Object(l["createVNode"])(s,{id:"start-tracking-cta",html:e.ctaContent},null,8,["html"]),Object(l["createVNode"])(o,{"loading-message":e.translate("SitesManager_DetectingYourSite")+"…",loading:e.loading},null,8,["loading-message","loading"]),e.loading||e.showMethodDetails?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],{key:1},[e.recommendedMethod?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",_t,[Object(l["createElementVNode"])("img",{src:e.recommendedMethod.icon,alt:e.recommendedMethod.name+" logo"},null,8,Gt),Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.recommendedMethod.recommendationTitle),1),Object(l["createElementVNode"])("p",null,Object(l["toDisplayString"])(e.recommendedMethod.recommendationText),1),Object(l["createElementVNode"])("a",{href:"#"+e.recommendedMethod.id.toLowerCase(),class:"btn",id:"showMethod",onClick:t[1]||(t[1]=Object(l["withModifiers"])(t=>e.showMethod(e.recommendedMethod.id),["prevent"]))},Object(l["toDisplayString"])(e.recommendedMethod.recommendationButton),9,Lt)])):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("div",At,[Ut,Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataOtherInstallMethods")),1),Object(l["createElementVNode"])("p",null,Object(l["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataOtherInstallMethodsIntro")),1),Object(l["createElementVNode"])("ul",null,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.trackingMethods,t=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("li",{class:"list-entry",key:t.id},[Object(l["createElementVNode"])("a",{href:"#"+t.id.toLowerCase(),onClick:Object(l["withModifiers"])(a=>e.showMethod(t.id),["prevent"])},[t.icon?(Object(l["openBlock"])(),Object(l["createElementBlock"])("img",{key:0,src:t.icon,class:"list-entry-icon"},null,8,It)):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("span",zt,Object(l["toDisplayString"])(t.name),1)],8,Bt)]))),128))])]),Object(l["createElementVNode"])("div",Ht,[Object(l["createElementVNode"])("h2",null,Object(l["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataNotYetReady")),1),Object(l["createElementVNode"])("div",null,Object(l["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataTemporarilyHidePage")),1),Object(l["createElementVNode"])("a",{href:e.ignoreSitesWithoutDataLink,class:"ignoreSitesWithoutData"},Object(l["toDisplayString"])(e.translate("SitesManager_SiteWithoutDataHidePageForHour")),9,Qt)])],64)),e.showMethodDetails?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:2,id:"start-tracking-details","data-method":e.showMethodDetails.id},[Object(l["createElementVNode"])("img",{src:e.showMethodDetails.icon,alt:e.showMethodDetails.name+" logo"},null,8,Rt),Object(l["createVNode"])(s,{html:e.showMethodDetails.content},null,8,["html"])],8,Ft)):Object(l["createCommentVNode"])("",!0)])}function Wt(){return Wt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},Wt.apply(this,arguments)}var Kt=Object(l["defineComponent"])({props:{ctaContent:String},components:{ActivityIndicator:n["ActivityIndicator"],VueEntryContainer:n["VueEntryContainer"]},data(){return{loading:!0,updateCheckInterval:1e3,currentInterval:1e3,maxInterval:3e4,showMethodDetails:null,recommendedMethod:null,trackingMethods:[]}},created(){const e={module:"SitesManager",action:"getTrackingMethodsForSite"};n["AjaxHelper"].fetch(e).then(e=>{this.trackingMethods=e.trackingMethods,this.recommendedMethod=e.recommendedMethod,this.loading=!1,Object(l["watch"])(()=>n["MatomoUrl"].hashParsed.value.activeTab,e=>{this.showMethodDetails=this.findTrackingMethod(e)}),n["MatomoUrl"].hashParsed.value.activeTab&&(this.showMethodDetails=this.findTrackingMethod(n["MatomoUrl"].hashParsed.value.activeTab)),this.checkIfSiteHasData()})},methods:{findTrackingMethod(e){if(this.recommendedMethod&&e&&this.recommendedMethod.id.toLowerCase()===e.toLowerCase())return this.recommendedMethod;let t=null;return Object.entries(this.trackingMethods).forEach(([,a])=>{e&&a.id.toLowerCase()===e.toLowerCase()&&(t=a)}),t},showMethod(e){n["MatomoUrl"].updateHash(Wt(Wt({},n["MatomoUrl"].hashParsed.value),{},{activeTab:e.toLowerCase()}))},showOverview(){n["MatomoUrl"].updateHash(Wt(Wt({},n["MatomoUrl"].hashParsed.value),{},{activeTab:null}))},checkIfSiteHasData(){const e={method:"Live.getMostRecentVisitsDateTime",date:"today",period:"day",idSite:n["Matomo"].idSite},t={createErrorNotification:!1};n["AjaxHelper"].fetch(e,t).then(e=>{e&&""!==e.value?window.broadcast.propagateNewPage("date=today"):(window.setTimeout(this.checkIfSiteHasData,this.currentInterval),this.currentInterval=Math.min(this.currentInterval+this.updateCheckInterval,this.maxInterval))}).catch(()=>{})}},computed:{ignoreSitesWithoutDataLink(){return"?"+n["MatomoUrl"].stringify(Wt(Wt({},n["MatomoUrl"].urlParsed.value),{},{module:"SitesManager",action:"ignoreNoDataMessage"}))},headline(){return this.showMethodDetails&&this.showMethodDetails.name?99===this.showMethodDetails.type?this.showMethodDetails.name:Object(n["translate"])("SitesManager_SiteWithoutDataInstallWithX",this.showMethodDetails.name):Object(n["translate"])("SitesManager_SiteWithoutDataChooseTrackingMethod")}}});Kt.render=$t;var qt=Kt;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=SitesManager.umd.min.js.map